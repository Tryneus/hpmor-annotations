{"version":3,"file":null,"sources":[null],"sourcesContent":["(function() {\n  // This whole thing could probably be simplified by using more globals, but w/e\n  // Used to track the currently displayed note\n  let activeNote;\n\n  const colors = {\n    'foreshadowing': '#aaa',\n    'consequence': '#f6f',\n    'reference': '#66f',\n    'departure': '#f90',\n    'original': '#af0',\n    'speculation': '#e0f',\n    'background': '#30f',\n    'spoiler': '#f00',\n  };\n\n  function handleFrameLoad() {\n    const frame = document.getElementById('hpmor-annotations-frame');\n    const innerDocument = frame.contentDocument;\n\n    // Rewrite links to open in this frame\n    Array.from(innerDocument.getElementsByTagName('a')).map((x) => {\n      if (x.target === '_top') {\n        x.target = '_self';\n      }\n    });\n\n    // The chapter select drop-down navigates from the top as well\n    innerDocument.getElementById('nav-form-top').target = '_self';\n\n    // Reposition the active note if the frame is resized\n    window.addEventListener('resize', positionNote);\n\n    // Update the window title/url and get the chapter number for annotations\n    window.history.replaceState({}, '', frame.contentWindow.location.href);\n    document.title = innerDocument.title;\n\n    activeNote = null;\n    annotate();\n  }\n\n  function installFrame() {\n    // Reload the page in an iframe, change links so that they only navigate the\n    // iframe instead of the top-level window, then apply the annotations to the\n    // iframe story contents any time a new page is loaded.\n    // TODO: do we need to / can we do some cleanup if the user navigates away from hpmor?\n    if (!document.getElementById('hpmor-annotations-frame')) {\n      while (document.body.children.length > 0) {\n        document.body.removeChild(document.body.children[0]);\n      }\n\n      const frame = document.createElement('iframe');\n      frame.id = 'hpmor-annotations-frame';\n\n      // TODO: is it possible to move the existing body into the iframe without reloading?\n      frame.src = window.location.href;\n      document.body.appendChild(frame);\n    }\n\n    const frame = document.getElementById('hpmor-annotations-frame');\n    frame.style.width = '100vw';\n    frame.style.height = '100vh';\n    frame.style.border = 'none';\n\n    frame.addEventListener('load', handleFrameLoad);\n\n    return frame;\n  }\n\n  function installNotes(innerDocument, annotations) {\n    const oldNotes = innerDocument.getElementById('hpmor-annotations-notes');\n\n    if (oldNotes) {\n      oldNotes.parentNode.removeChild(oldNotes);\n    }\n\n    const notes = innerDocument.createElement('div');\n    notes.id = 'hpmor-annotations-notes';\n    innerDocument.body.insertBefore(notes, innerDocument.body.childNodes[0]);\n\n    // For each annotation, add a div which is hidden until the annotation is clicked\n    Object.values(annotations).forEach((annotation) => {\n      const color = colors[annotation.tags[0]];\n      const note = document.createElement('div');\n      note.id = `${annotation.id}-note`;\n      note.className = 'hpmor-annotations-note';\n      note.onclick = dismissNote;\n      note.innerHTML = `\n        <div class=\"hpmor-annotations-note-container\">\n          <div>\n            <div class=\"hpmor-annotations-note-tags\" style=\"background: ${color}\">${annotation.tags.join(' / ')}</div>\n            <div class=\"hpmor-annotations-note-text\" style=\"border-color: ${color}\">${annotation.note}</div>\n          </div>\n          <div class=\"hpmor-annotations-note-bracket\" style=\"border-color: ${color}\"></div>\n        </div>`;\n      notes.appendChild(note);\n    });\n  }\n\n  function installSpans(content, annotations) {\n    getAnnotationSpans(content).forEach((span) => {\n      span.outerHTML = span.innerHTML;\n    });\n\n    // Normalize the HTML so we can find and replace\n    let innerHTML = content.innerHTML.replace(/[\\n ]+/g, ' ');\n\n    // Wrap the annotated text in spans so we can underline and expand on click\n    Object.values(annotations).forEach((annotation) => {\n      // TODO: this is only replacing the first occurence, use expect/useIndex\n      innerHTML = innerHTML.replace(annotation.text, annotation.replacement);\n    });\n\n    content.innerHTML = innerHTML;\n\n    getAnnotationSpans(content).forEach((span) => {\n      const id = span.attributes.annotation.value;\n      const annotation = annotations[id];\n\n      if (!annotation) {\n        console.error('hpmor-annotations: Could not find annotation', id);\n        return null;\n      }\n\n      const color = colors[annotation.tags[0]];\n      span.style['text-decoration-color'] = color;\n\n      span.onclick = (ev) => toggleNote(id, ev);\n      // TODO: onhover handler to show tooltip with tags\n    });\n  }\n\n  function annotate() {\n    const frame = installFrame();\n\n    if (!frame) {\n      console.error('hpmor-annotations: Could not find iframe.');\n    } else {\n      const href = frame.contentWindow.location.href;\n      const matches = href.match(/\\/([0-9]+)(\\.html)?$/);\n      const chapter = matches && parseInt(matches[1]);\n      const content = frame.contentDocument.getElementById('storycontent');\n\n      if (!chapter) {\n        console.error('hpmor-annotations: Could not determine chapter.', href);\n      } else if (!content) {\n        console.error('hpmor-annotations: Could not find story content.');\n      } else {\n        installCss(frame.contentDocument);\n\n        fetchAnnotations(chapter, (annotations) => {\n          const innerContent = wrapContent(frame.contentDocument, content);\n          installSpans(innerContent, annotations);\n          installNotes(frame.contentDocument, annotations);\n        });\n      }\n    }\n  }\n\n  function installCss(frameDocument) {\n    if (!frameDocument.getElementById('hpmor-annotations-css')) {\n      const styleElement = frameDocument.createElement('style');\n      styleElement.id = 'hpmor-annotations-css';\n      styleElement.type = 'text/css';\n      frameDocument.head.appendChild(styleElement);\n    }\n\n    const css = frameDocument.getElementById('hpmor-annotations-css');\n    css.innerHTML = `\n#storycontent {\n    display: flex;\n    flex-direction: row;\n    margin-left: unset;\n    margin-right: unset;\n    max-width: none;\n  }\n\n#hpmor-annotations-wrapped-content {\n    flex: 0 0 auto;\n    max-width: 42em;\n  }\n\n  .hpmor-annotations-left-panel {\n    flex: 1 1 300px;\n  }\n\n  .hpmor-annotations-right-panel {\n    flex: 1 3 300px;\n  }\n\n  .hpmor-annotations-note {\n    position: absolute;\n    display: none;\n    left: 0;\n  }\n\n  .hpmor-annotations-note-container {\n    display: flex;\n    height: 100%;\n    margin-left: 5px;\n    cursor: default;\n    justify-content: flex-end;\n  }\n\n  .hpmor-annotations-note-tags {\n    font: 600 15px \"PT Sans\", Georgia;\n    font-variant: all-small-caps;\n    border-radius: 5px 5px 0 0;\n    padding: 0 7px;\n  }\n\n  .hpmor-annotations-note-text {\n    border-radius: 0 0 5px 5px;\n    background: #f0f0f0;\n    border-width: 1px;\n    font: 12px sans-serif;\n    padding: 7px;\n    flex-shrink: 0;\n  }\n\n  .hpmor-annotations-note-bracket {\n    min-width: 3px;\n    border-width: 2px;\n    border-right-color: #fff0;\n    margin: 0 5px;\n  }\n\n  .hpmor-annotations-link {\n    text-decoration: none;\n  }\n\n  .hpmor-annotations-link:hover {\n    text-decoration: underline;\n  }\n\n  .hpmor-annotations-span {\n    text-decoration-line: dotted;\n    text-decoration-style: underline;\n    cursor: pointer;\n  }\n    `;\n  }\n\n  // Weight the left and right margins differently so we get a little more space\n  // to put the annotations in.\n  function wrapContent(frameDocument, content) {\n    // Check if we've already wrapped content and return the inner div\n    if (!frameDocument.getElementById('hpmor-annotations-wrapped-content')) {\n      content.innerHTML = `\n        <div class=\"hpmor-annotations-left-panel\"></div>\n        <div id=\"hpmor-annotations-wrapped-content\">\n          ${content.innerHTML}\n        </div>\n        <div class=\"hpmor-annotations-right-panel\"></div>`;\n    }\n\n    return frameDocument.getElementById('hpmor-annotations-wrapped-content');\n  }\n\n  function getAnnotationSpans(content) {\n    return Array.from(content.getElementsByTagName('span'))\n      .filter((span) =>\n        span.attributes.annotation &&\n          span.attributes.annotation.value.match(/^hpmor-[0-9]+-[0-9]+$/)\n      );\n  }\n\n  function fetchAnnotations(chapter, callback) {\n    const xhr = new XMLHttpRequest();\n    xhr.open('GET', `https://tryneus.github.io/hpmor-annotations/dist/annotation/${chapter}.json`);\n    xhr.send();\n    xhr.onerror = () => {\n      console.error('hpmor-annotations: Could not load annotations.');\n    };\n\n    xhr.onload = () => {\n      if (xhr.status !== 200) {\n        console.error('hpmor-annotations: Loading annotations failed, status:', xhr.status);\n      } else {\n        callback(parseAnnotations(xhr.response));\n      }\n    };\n  }\n\n  function parseAnnotations(raw) {\n    try {\n      return JSON.parse(raw);\n    } catch (err) {\n      console.error('hpmor-annotations: Failed to parse annotations', err);\n    }\n  }\n\n  function getNoteDiv(id) {\n    return document.getElementById('hpmor-annotations-frame').contentDocument.getElementById(`${id}-note`);\n  }\n\n  function toggleNote(id, ev) {\n    const note = getNoteDiv(id);\n\n    // TODO: are these necessary?\n    ev.preventDefault();\n    ev.stopPropagation();\n\n    if (activeNote) {\n      if (activeNote !== note) {\n        dismissNote();\n      } else {\n        dismissNote();\n        return;\n      }\n    }\n\n    activeNote = note;\n    note.style.display = 'block';\n    positionNote();\n  }\n\n  function positionNote() {\n    if (!activeNote) { return; }\n\n    const id = activeNote.id.match(/^(hpmor-[0-9]+-[0-9]+)-note$/)[1];\n    const frame = document.getElementById('hpmor-annotations-frame');\n    const content = frame.contentDocument.getElementById('hpmor-annotations-wrapped-content');\n    const spans = Array.from(frame.contentDocument.getElementsByTagName('span'))\n      .filter((span) =>\n        span.attributes.annotation &&\n          span.attributes.annotation.value === id);\n\n    // Find the top/bottom offsets of the annotation\n    const dimensions = spans.reduce((acc, span) => {\n      const {top, bottom} = span.getBoundingClientRect();\n      return {\n        top: (acc && (acc.top < top ? acc.top : top)) || top,\n        bottom: (acc && (acc.bottom > bottom ? acc.bottom : bottom)) || bottom,\n      };\n    }, {});\n\n    // Position the note so that it sits next to the annotated text\n    activeNote.style.width = `${content.getBoundingClientRect().left + frame.contentWindow.pageXOffset}px`;\n    activeNote.style.top = `${dimensions.top + frame.contentWindow.pageYOffset}px`;\n    activeNote.style.height = `${dimensions.bottom - dimensions.top}px`;\n\n    // TODO: use an overlay layout if not enough x space\n  }\n\n  function dismissNote() {\n    activeNote.style.display = null;\n    activeNote = null;\n  }\n\n  // Dev function for ease-of-use\n  // TODO: remove this later\n  function reloadScript() {\n    const oldScript = document.getElementById('hpmor-annotations-script');\n\n    if (!oldScript) {\n      console.error('Could not find script to reload.');\n    } else {\n      // Clear any event listeners that we installed\n      const frame = document.getElementById('hpmor-annotations-frame');\n      frame.removeEventListener('load', handleFrameLoad);\n      window.removeEventHandler('resize', positionNote);\n\n      const newScript = document.createElement('script');\n      newScript.src = oldScript.src.replace('dist', 'src');\n\n      // Drop the old script element and add a new one\n      oldScript.parentNode.removeChild(oldScript);\n      document.body.appendChild(newScript);\n    }\n  }\n\n  const exports = {installFrame, annotate, reloadScript};\n\n  // Export everything for unit tests\n  if (typeof module !== 'undefined' && module.exports) {\n    module.exports = exports;\n  } else {\n    window.hpmorAnnotations = exports;\n  }\n})();\n"],"names":["activeNote","colors","handleFrameLoad","installFrame","installNotes","installSpans","annotate","installCss","wrapContent","getAnnotationSpans","fetchAnnotations","parseAnnotations","getNoteDiv","toggleNote","positionNote","dismissNote","reloadScript","exports","frame","innerDocument","x","annotations","oldNotes","notes","annotation","color","note","content","innerHTML","span","id","ev","href","matches","chapter","innerContent","frameDocument","css","styleElement","callback","xhr","raw","err","spans","dimensions","acc","top","bottom","oldScript","newScript"],"mappings":"CAAC,QAAQ,EAAG,CAAC,AAGX,IAAIA,CAAU,CAERC,CAAM,CAAG,CACb,eAAe,CAAE,MAAM,CACvB,aAAa,CAAE,MAAM,CACrB,WAAW,CAAE,MAAM,CACnB,WAAW,CAAE,MAAM,CACnB,UAAU,CAAE,MAAM,CAClB,aAAa,CAAE,MAAM,CACrB,YAAY,CAAE,MAAM,CACpB,SAAS,CAAE,MAAM,AACnB,CAAC,CAED,SAASC,CAAe,EAAG,CAAC,AAC1B,IAAMgB,CAAK,CAAG,QAAQ,CAAC,cAAc,CAAC,yBAAyB,CAAC,CAC1DC,CAAa,CAAGD,CAAK,CAAC,eAAe,CAG3C,KAAK,CAAC,IAAI,CAACC,CAAa,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,AAACC,CAAC,EAAK,CAAC,AAC1DA,CAAC,CAAC,MAAM,GAAK,MAAM,GACrBA,CAAC,CAAC,MAAM,CAAG,OAAO,CAEtB,CAAC,CAAC,CAGFD,CAAa,CAAC,cAAc,CAAC,cAAc,CAAC,CAAC,MAAM,CAAG,OAAO,CAG7D,MAAM,CAAC,gBAAgB,CAAC,QAAQ,CAAEL,CAAY,CAAC,CAG/C,MAAM,CAAC,OAAO,CAAC,YAAY,CAAC,EAAE,CAAE,EAAE,CAAEI,CAAK,CAAC,aAAa,CAAC,QAAQ,CAAC,IAAI,CAAC,CACtE,QAAQ,CAAC,KAAK,CAAGC,CAAa,CAAC,KAAK,CAEpCnB,CAAU,CAAG,IAAI,CACjBM,CAAQ,EAAE,AACZ,CAAC,AAED,SAASH,CAAY,EAAG,CAAC,AAKvB,EAAE,CAAE,CAAC,QAAQ,CAAC,cAAc,CAAC,yBAAyB,CAAC,CAAE,CAAC,AACxD,KAAK,CAAE,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAG,CAAC,CACtC,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,GAAG,CAAC,CAGtD,IAAMe,CAAK,CAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAC9CA,CAAK,CAAC,EAAE,CAAG,yBAAyB,CAGpCA,CAAK,CAAC,GAAG,CAAG,MAAM,CAAC,QAAQ,CAAC,IAAI,CAChC,QAAQ,CAAC,IAAI,CAAC,WAAW,CAACA,CAAK,CAAC,AAClC,CAAC,AAED,IAAMA,CAAK,CAAG,QAAQ,CAAC,cAAc,CAAC,yBAAyB,CAAC,CAChEA,CAAK,CAAC,KAAK,CAAC,KAAK,CAAG,OAAO,CAC3BA,CAAK,CAAC,KAAK,CAAC,MAAM,CAAG,OAAO,CAC5BA,CAAK,CAAC,KAAK,CAAC,MAAM,CAAG,MAAM,CAE3BA,CAAK,CAAC,gBAAgB,CAAC,MAAM,CAAEhB,CAAe,CAAC,CAE/C,OAAOgB,CACT,CAAC,AAED,SAASd,CAAY,CAACe,CAAa,CAAEE,CAAW,CAAE,CAAC,AACjD,IAAMC,CAAQ,CAAGH,CAAa,CAAC,cAAc,CAAC,yBAAyB,CAAC,CAEpEG,CAAQ,EACVA,CAAQ,CAAC,UAAU,CAAC,WAAW,CAACA,CAAQ,CAAC,CAG3C,IAAMC,CAAK,CAAGJ,CAAa,CAAC,aAAa,CAAC,KAAK,CAAC,CAChDI,CAAK,CAAC,EAAE,CAAG,yBAAyB,CACpCJ,CAAa,CAAC,IAAI,CAAC,YAAY,CAACI,CAAK,CAAEJ,CAAa,CAAC,IAAI,CAAC,UAAU,GAAG,CAAC,CAGxE,MAAM,CAAC,MAAM,CAACE,CAAW,CAAC,CAAC,OAAO,CAAC,AAACG,CAAU,EAAK,CAAC,AAClD,IAAMC,CAAK,CAAGxB,CAAM,CAACuB,CAAU,CAAC,IAAI,GAAG,CAAC,CAClCE,CAAI,CAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAC1CA,CAAI,CAAC,EAAE,CAAG,CAAC,EAAEF,CAAU,CAAC,EAAE,CAAC,KAAK,CAAC,CACjCE,CAAI,CAAC,SAAS,CAAG,wBAAwB,CACzCA,CAAI,CAAC,OAAO,CAAGX,EACfW,CAAI,CAAC,SAAS,CAAG,CAAC;;;wEAGgD,EAAED,CAAK,CAAC,EAAE,EAAED,CAAU,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;0EACtC,EAAEC,CAAK,CAAC,EAAE,EAAED,CAAU,CAAC,IAAI,CAAC;;2EAE3B,EAAEC,CAAK,CAAC;cACrE,CAAC,CACTF,CAAK,CAAC,WAAW,CAACG,CAAI,CAAC,AACzB,CAAC,CAAC,AACJ,CAAC,AAED,SAASrB,CAAY,CAACsB,CAAO,CAAEN,CAAW,CAAE,CAAC,AAC3CZ,CAAkB,CAACkB,CAAO,CAAC,CAAC,OAAO,CAAC,AAACE,CAAI,EAAK,CAAC,AAC7CA,CAAI,CAAC,SAAS,CAAGA,CAAI,CAAC,SAAS,AACjC,CAAC,CAAC,CAGF,IAAID,CAAS,CAAGD,CAAO,CAAC,SAAS,CAAC,OAAO,CAAC,SAAS,CAAE,GAAG,CAAC,CAGzD,MAAM,CAAC,MAAM,CAACN,CAAW,CAAC,CAAC,OAAO,CAAC,AAACG,CAAU,EAAK,CAAC,AAElDI,CAAS,CAAGA,CAAS,CAAC,OAAO,CAACJ,CAAU,CAAC,IAAI,CAAEA,CAAU,CAAC,WAAW,CAAC,AACxE,CAAC,CAAC,CAEFG,CAAO,CAAC,SAAS,CAAGC,EAEpBnB,CAAkB,CAACkB,CAAO,CAAC,CAAC,OAAO,CAAC,AAACE,CAAI,EAAK,CAAC,AAC7C,IAAMC,CAAE,CAAGD,CAAI,CAAC,UAAU,CAAC,UAAU,CAAC,KAAK,CACrCL,CAAU,CAAGH,CAAW,CAACS,CAAE,CAAC,CAElC,EAAE,CAAE,CAACN,CAAU,CAAE,CAAC,AAChB,OAAO,CAAC,KAAK,CAAC,8CAA8C,CAAEM,CAAE,CAAC,CACjE,OAAO,IAAI,AACb,CAAC,AAED,IAAML,CAAK,CAAGxB,CAAM,CAACuB,CAAU,CAAC,IAAI,GAAG,CAAC,CACxCK,CAAI,CAAC,KAAK,CAAC,uBAAuB,CAAC,CAAGJ,EAEtCI,CAAI,CAAC,OAAO,CAAIE,CAAE,EAAKlB,CAAU,CAACiB,CAAE,CAAEC,CAAE,CAAC,AAE3C,CAAC,CAAC,AACJ,CAAC,AAED,SAASzB,CAAQ,EAAG,CAAC,AACnB,IAAMY,CAAK,CAAGf,CAAY,EAAE,CAE5B,EAAE,CAAE,CAACe,CAAK,CACR,OAAO,CAAC,KAAK,CAAC,2CAA2C,CAAC,AAC3D,KAAM,CAAC,AACN,IAAMc,CAAI,CAAGd,CAAK,CAAC,aAAa,CAAC,QAAQ,CAAC,IAAI,CACxCe,CAAO,CAAGD,CAAI,CAAC,KAAK,CAAC,sBAAsB,CAAC,CAC5CE,CAAO,CAAGD,CAAO,EAAI,QAAQ,CAACA,CAAO,GAAG,CAAC,CACzCN,CAAO,CAAGT,CAAK,CAAC,eAAe,CAAC,cAAc,CAAC,cAAc,CAAC,CAE/DgB,CAAO,CAEAP,CAAO,EAGjBpB,CAAU,CAACW,CAAK,CAAC,eAAe,CAAC,CAEjCR,CAAgB,CAACwB,CAAO,CAAGb,CAAW,EAAK,CAAC,AAC1C,IAAMc,CAAY,CAAG3B,CAAW,CAACU,CAAK,CAAC,eAAe,CAAES,CAAO,CAAC,CAChEtB,CAAY,CAAC8B,CAAY,CAAEd,CAAW,CAAC,CACvCjB,CAAY,CAACc,CAAK,CAAC,eAAe,CAAEG,CAAW,CAAC,AAClD,CAAC,CAAC,EARF,OAAO,CAAC,KAAK,CAAC,kDAAkD,CAAC,CAFjE,OAAO,CAAC,KAAK,CAAC,iDAAiD,CAAEW,CAAI,CAAC,AAY1E,CAAC,AACH,CAAC,AAED,SAASzB,CAAU,CAAC6B,CAAa,CAAE,CAAC,AAClC,EAAE,CAAE,CAACA,CAAa,CAAC,cAAc,CAAC,uBAAuB,CAAC,CAAE,CAAC,AAC3D,IAAME,CAAY,CAAGF,CAAa,CAAC,aAAa,CAAC,OAAO,CAAC,CACzDE,CAAY,CAAC,EAAE,CAAG,uBAAuB,CACzCA,CAAY,CAAC,IAAI,CAAG,UAAU,CAC9BF,CAAa,CAAC,IAAI,CAAC,WAAW,CAACE,CAAY,CAAC,AAC9C,CAAC,AAED,IAAMD,CAAG,CAAGD,CAAa,CAAC,cAAc,CAAC,uBAAuB,CAAC,CACjEC,CAAG,CAAC,SAAS,CAAG,u3CAyElB,CAAC,AAID,SAAS7B,CAAW,CAAC4B,CAAa,CAAET,CAAO,CAAE,CAAC,AAEvCS,CAAa,CAAC,cAAc,CAAC,mCAAmC,CAAC,GACpET,CAAO,CAAC,SAAS,CAAG,CAAC;;;UAGjB,EAAEA,CAAO,CAAC,SAAS,CAAC;;yDAE2B,CAAC,EAGtD,OAAOS,CAAa,CAAC,cAAc,CAAC,mCAAmC,CAAC,AAC1E,CAAC,AAED,SAAS3B,CAAkB,CAACkB,CAAO,CAAE,CAAC,AACpC,OAAO,KAAK,CAAC,IAAI,CAACA,CAAO,CAAC,oBAAoB,CAAC,MAAM,CAAC,CAAC,CACpD,MAAM,CAAC,AAACE,CAAI,EACXA,CAAI,CAAC,UAAU,CAAC,UAAU,EACxBA,CAAI,CAAC,UAAU,CAAC,UAAU,CAAC,KAAK,CAAC,KAAK,CAAC,uBAAuB,CAAC,CAEvE,CAAC,AAED,SAASnB,CAAgB,CAACwB,CAAO,CAAEK,CAAQ,CAAE,CAAC,AAC5C,IAAMC,CAAG,CAAG,IAAI,cAAc,CAC9BA,CAAG,CAAC,IAAI,CAAC,KAAK,CAAE,CAAC,4DAA4D,EAAEN,CAAO,CAAC,KAAK,CAAC,CAAC,CAC9FM,CAAG,CAAC,IAAI,EAAE,CACVA,CAAG,CAAC,OAAO,CAAG,IAAM,CAAC,AACnB,OAAO,CAAC,KAAK,CAAC,gDAAgD,CAAC,AACjE,CAAC,CAEDA,CAAG,CAAC,MAAM,CAAG,IAAM,CAAC,AACdA,CAAG,CAAC,MAAM,GAAK,GAAG,CACpB,OAAO,CAAC,KAAK,CAAC,wDAAwD,CAAEA,CAAG,CAAC,MAAM,CAAC,CAEnFD,CAAQ,CAAC5B,CAAgB,CAAC6B,CAAG,CAAC,QAAQ,CAAC,CAAC,AAE5C,CAAC,AACH,CAAC,AAED,SAAS7B,CAAgB,CAAC8B,CAAG,CAAE,CAAC,AAC9B,GAAG,AAAC,CAAC,AACH,OAAO,IAAI,CAAC,KAAK,CAACA,CAAG,CAAC,AACxB,CAAC,AAAC,KAAK,CAAEC,CAAG,CAAE,CAAC,AACb,OAAO,CAAC,KAAK,CAAC,gDAAgD,CAAEA,CAAG,CAAC,AACtE,CAAC,AACH,CAAC,AAED,SAAS9B,CAAU,CAACkB,CAAE,CAAE,CAAC,AACvB,OAAO,QAAQ,CAAC,cAAc,CAAC,yBAAyB,CAAC,CAAC,eAAe,CAAC,cAAc,CAAC,CAAC,EAAEA,CAAE,CAAC,KAAK,CAAC,CAAC,AACxG,CAAC,AAED,SAASjB,CAAU,CAACiB,CAAE,CAAEC,CAAE,CAAE,CAAC,AAC3B,IAAML,CAAI,CAAGd,CAAU,CAACkB,CAAE,CAAC,CAG3BC,CAAE,CAAC,cAAc,EAAE,CACnBA,CAAE,CAAC,eAAe,EAAE,CAEpB,EAAE,CAAE/B,CAAU,CAAE,CAAC,AACf,EAAE,CAAEA,CAAU,GAAK0B,CAAI,CACrBX,CAAW,EAAE,AACd,KAAM,CAAC,AACNA,CAAW,EAAE,CACb,MAAM,AACR,CAAC,AACH,CAAC,AAEDf,CAAU,CAAG0B,EACbA,CAAI,CAAC,KAAK,CAAC,OAAO,CAAG,OAAO,CAC5BZ,CAAY,EAAE,AAChB,CAAC,AAED,SAASA,CAAY,EAAG,CAAC,AACvB,EAAE,CAAE,CAACd,CAAU,CAAE,CAAC,AAAC,MAAM,AAAE,CAAC,AAE5B,IAAM8B,CAAE,CAAG9B,CAAU,CAAC,EAAE,CAAC,KAAK,CAAC,8BAA8B,CAAC,GAAG,CAC3DkB,CAAK,CAAG,QAAQ,CAAC,cAAc,CAAC,yBAAyB,CAAC,CAC1DS,CAAO,CAAGT,CAAK,CAAC,eAAe,CAAC,cAAc,CAAC,mCAAmC,CAAC,CACnFyB,CAAK,CAAG,KAAK,CAAC,IAAI,CAACzB,CAAK,CAAC,eAAe,CAAC,oBAAoB,CAAC,MAAM,CAAC,CAAC,CACzE,MAAM,CAAC,AAACW,CAAI,EACXA,CAAI,CAAC,UAAU,CAAC,UAAU,EACxBA,CAAI,CAAC,UAAU,CAAC,UAAU,CAAC,KAAK,GAAKC,CAAE,CAAC,CAGxCc,CAAU,CAAGD,CAAK,CAAC,MAAM,CAAC,CAACE,CAAG,CAAEhB,CAAI,GAAK,CAAC,AAC9C,GAAM,CAACiB,KAAG,CAAEC,QAAM,CAAC,CAAGlB,CAAI,CAAC,qBAAqB,EAAE,CAClD,MAAM,AAAC,CACL,GAAG,CAAGgB,CAAG,EAAI,CAACA,CAAG,CAAC,GAAG,CAAGC,CAAG,CAAGD,CAAG,CAAC,GAAG,CAAGC,CAAG,CAAC,AAAC,EAAIA,CAAG,CACpD,MAAM,CAAGD,CAAG,EAAI,CAACA,CAAG,CAAC,MAAM,CAAGE,CAAM,CAAGF,CAAG,CAAC,MAAM,CAAGE,CAAM,CAAC,AAAC,EAAIA,CAClE,CAAC,AACH,CAAC,CAAE,EAAE,CAAC,CAGN/C,CAAU,CAAC,KAAK,CAAC,KAAK,CAAG,CAAC,EAAE2B,CAAO,CAAC,qBAAqB,EAAE,CAAC,IAAI,CAAGT,CAAK,CAAC,aAAa,CAAC,WAAW,CAAC,EAAE,CAAC,CACtGlB,CAAU,CAAC,KAAK,CAAC,GAAG,CAAG,CAAC,EAAE4C,CAAU,CAAC,GAAG,CAAG1B,CAAK,CAAC,aAAa,CAAC,WAAW,CAAC,EAAE,CAAC,CAC9ElB,CAAU,CAAC,KAAK,CAAC,MAAM,CAAG,CAAC,EAAE4C,CAAU,CAAC,MAAM,CAAGA,CAAU,CAAC,GAAG,CAAC,EAAE,CAAC,AAGrE,CAAC,AAED,SAAS7B,CAAW,EAAG,CAAC,AACtBf,CAAU,CAAC,KAAK,CAAC,OAAO,CAAG,IAAI,CAC/BA,CAAU,CAAG,IAAI,AACnB,CAAC,AAID,SAASgB,CAAY,EAAG,CAAC,AACvB,IAAMgC,CAAS,CAAG,QAAQ,CAAC,cAAc,CAAC,0BAA0B,CAAC,CAErE,EAAE,CAAE,CAACA,CAAS,CACZ,OAAO,CAAC,KAAK,CAAC,kCAAkC,CAAC,AAClD,KAAM,CAAC,AAEN,IAAM9B,CAAK,CAAG,QAAQ,CAAC,cAAc,CAAC,yBAAyB,CAAC,CAChEA,CAAK,CAAC,mBAAmB,CAAC,MAAM,CAAEhB,CAAe,CAAC,CAClD,MAAM,CAAC,kBAAkB,CAAC,QAAQ,CAAEY,CAAY,CAAC,CAEjD,IAAMmC,CAAS,CAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAClDA,CAAS,CAAC,GAAG,CAAGD,CAAS,CAAC,GAAG,CAAC,OAAO,CAAC,MAAM,CAAE,KAAK,CAAC,CAGpDA,CAAS,CAAC,UAAU,CAAC,WAAW,CAACA,CAAS,CAAC,CAC3C,QAAQ,CAAC,IAAI,CAAC,WAAW,CAACC,CAAS,CAAC,AACtC,CAAC,AACH,CAAC,AAED,IAAMhC,CAAO,CAAG,CAACd,cAAY,CAAEG,UAAQ,CAAEU,cAAY,CAAC,CAGlD,MAAM,CAAC,MAAM,GAAK,WAAW,EAAI,MAAM,CAAC,OAAO,EACjD,MAAM,CAAC,OAAO,CAAGC,IAEjB,MAAM,CAAC,gBAAgB,CAAGA,EAE9B,CAAC,AAAC,EAAE"}